---
title:  "Ruby on Rails [Chapter 1]"
excerpt: ""

categories:
  - RubyonRails
tags:
  - [ruby, rails, Github]

breadcrumb: true
#classes: wide
toc: true
toc_sticky: true
 
date: 2021-06-06
last_modified_at: 2021-06-06
---

# CH_1 From zero to deploy
## 들어가며,,
이 책의 목적은 custom web application을 어떻게 개발하는지이다. 
`x = 4`{:.ruby}
`x = 4`{:.ruby}
---
box 1.1. Technical sophistication
우리는 기술적으로 정교해야된다. 그 예시로는 올바른 Ruby gem version을 사용한다던가, bundle 설치나 업데이트를 실행하는 것 등이 있다. 
---

이 책에서는 웹 개발에 필요한 Ruby, Rails, HTML & CSS, database, version control, testing, deployment 등을 배우면서 웹 개발자로서의 기초를 다질 수 있다.
또한 MVC, REST, generator, migration 등등 레일즈 프레임워크의 필수 요소들을 알 수 있을 것이다. 
이 책을 다 읽고나면 한층 성장해 있을 것이다.

이 책은 hello app(1.3절), toy app(CH-2), sample app(CH-3 ~ CH-14) 3가지의 example application 을 구축해 웹 개발에 접근한다. 

CH-1 에서는 필요한 소프트웨어를 모두 설치하고 개발환경을 설정함으로서 Ruby on Rails를 시작할 것이다. 그런 다음에 hello_app 이라는 첫 번째 rails application을 만들 것이다.
Rails 프로젝트를 만든 직후에는 Git으로 버전 관리를 할 예정이다.

CH-2 에서는 두번째 프로젝트를 만들 것이다. 빠르게 만들고 실행하기 위해 scaffold를 이용해서 toy app을 만들 것이다.

CH-3는 sample app을 개발하는데, 이 어플은 처음부터 모든 코드를 작성하는데 초점을 맞춘다. TDD, Integration test등을 조합해 sample app을 개발할 예정이다.
3장에서는 정적인 페이지를 만든 다음 약간의 동적 내용을 추가할 예정이다.
4장에서는 레일즈의 밑바탕에 깔린 루비언어에 대해 조금 배울 것이다. 
5장부터 12장까지는 사이트 레이아웃, user data 모델, 인증 시스템 등을 만들어 sample application의 기초를 완성한다.
마지막으로 13,14장에 microblogging과 social 기능을 이용해서 예시사이트를 만들 예정이다.
---
box 1.2. Scaffolding
Scaffolding 은 명령어 하나로 쉽고 빠르게 웹페이지를 구축 할 수 있다는 점에서 매혹적이지만, 그 속에 숨어있는 방대한 양의 코드를 보면 초보 개발자는 압도당할 것이다.
Scaffolding 으로 접근하는 것은 레일즈에 대한 지식이 거의 없고, 스크립트만 생성하는 개발자가 될 가능성이 높다.
2장에서는 Scaffolding을 사용해 볼 것이고, 3장부터는 직접 기능을 하나하나 구현 해 볼 것이다.
위를 통해 레일즈에 대한 더 깊고 유연한 지식이 쌓일 것이며, 거의 모든 종류의 웹 어플리케이션을 사용 할 수 있는 좋은 기초가 될 것이다.
---

## 1.1 Introduction
Ruby on Rails(또는 "Rails")는 Ruby 프로그래밍 언어로 작성된 웹 개발 프레임워크다. 루비 온 레일즈는 2004년에 처음 선보여진 이후, 빠르게 역동적인 웹 어플리케이션을 구축하는 가장 강력하고 인기 있는 도구 중 하나가 되었다. 레일즈는 Airbnb, Basecamp, Disney, GitHub, Hulu, Kickstarter, Shopify, Twitter, and the Yellow Pages 처럼 다양한 기업들이 이용하고 있다. 또한 ENTP, thinkbot, Pivotal Labs, Hashrocket, HappyFunCorp 등 레일즈를 전문으로 하는 웹 개발 shop이 많이 있으며, 그 외에도 수많은 독립적인 컨설턴트, 트레이너, 계약업체 등이 있다.

Ruby on Rails는 100% 오픈소스이구 때문에 다운로드 하는데 어떠한 비용도 지불하지 않아도 된다. Rails는 또한 부드럽고 컴팩트한 디자인이다. 
Rails는 웹 어플리케이션을 작성하기 위한 DSL을 효과적으로 만들 수 있다.
또한 웹 기술과 프레임워크 설계의 새로운 개발에 빠르게 적응한다. 예시로 레일즈는 REST 아키텍처 스타일을 완전히 소화 및 구현한 프레임워크이다.

### 1.1.1 Prerequisites

이 책을 읽기 전에 사전지식이 필요하지 않다.
레일즈 뿐만 아니라, 루비언어, 기본 레일즈 테스팅 프레임워크, 유닉스 커맨드, HTML, CSS, 약간의 JS와 SQL도 포함하고 있다.
그러나 이 책을 시작하기 전에 HTML과 프로그래밍 지식을 습득하기를 추천한다.

레일즈를 배울 때 한가지 공통적인 질문은 루비를 먼저 배울 것인가 하는 것이다. 답은 개인의 학습 스타일과 이미 얼마나 많은 프로그래밍 경험을 가지고 있느냐에 달려있다. 만약 당신이 모든것을 처음부터 체계적으로 배우기를 원하거나, 프로그래밍을 해본 적이 없다면, 루비를 먼저 배우는 것이 잘 맞을 수도 있다. 그러나 루비보다 레일즈에 집중하고 싶은 개발자들은 이 책을 쭉 보면 될 것이다.

이 책을 마치면 더 복잡하고 어려운 레일즈 정보들을 찾아봐야 한다. 그 예시로는 다음과 같은 사이트들이 있다.
* The Learn Enough Society
* The Turing School of Sofrware & Design
* Bloc
* Launch School
* Thinkful
* Pragmatic Studio
* RailsApps
* Rails Guides

이 책에는 많은 exercise가 포함되어 있다. 
일단 간단한 exercise를 내보겠다.
1. Ruby on Rails의 Ruby gem을 호스팅하는 웹사이트는 어디인가?
A : [RubyGems.org](https://rubygems.org)
3. 레일즈의 현재 버전은?
A :  [6.1.0.rc2](https://rubygems.org/gems/rails/versions/6.1.0.rc2) - December 01, 2020
5. Ruby on Rails가 다운로드 된 횟수는?
A : 254,385,035

위의 답변은 20년 12월 2일 기준.

### 1.1.2 Conventions used in this book

이 책에서 사용하는 convention들은 대부분 설명이 되어있다. 이 파트에서는 그렇지 않을 수도 있는 몇 가지를 살펴보겠다.

이 책의 많은 예시들은 커맨드라인 명령을 사용한다. 단순화하기 위해 모든 커맨드라인 예시는 다음과 같이 Unix 스타일의 커맨드라인 프롬프트($ 기호)를 사용한다. 

[image:EA77CDEF-3FC1-4B06-95F1-C48F54D5D832-27028-00002D37A468B8CB/image.png]

그리고 경로 같은 경우 축약되서 나타내진다
예를 들면 책에
config/environments/production.rb 로 적혀있는 경로는
사실 
/home/ec2-user/environment/sample_app/config/environments/production.rb
이 경로이다.

즉, 이 책에서는 절대경로가 아닌 상대경로로 나타낸다.

또한 TDD를 할 때, 틀린 테스트일 때는 RED, 맞는 테스트일 때는 GREEN으로 표시된다.

그리고 
[image:166EAD11-BF2B-44E7-A336-04292DCC5F3C-29708-000033B18677C97C/image.png]

이렇게 하이라이팅 된 코드는 새로 추가된 코드임을 뜻한다.
또한
[image:85D20DDF-2575-460E-89BF-83469CC0FA4D-29708-000033B1F74C4896/image.png]
이렇게 점으로 표시된것은 생략한다는 의미로, 저 점까지 복사 붙여넣기 해서는 안된다.

## 1.2 Up and running
### 1.2.1 Development environment
이 파트는 세팅 관련된 부분이므로 생략

### 1.2.2 Installing Rails

```bash
$ gem install rails -v 5.2.3
```

위와 같이 버전을 특정해서 설치해야 일관성 있는 결과를 얻을 수 있다.

## 1.3 The first application
처음으로는 hello app을 만들 예정이다.
hello app을 만드는 명령어는 다음과 같다.

```bash
$ rails _5.2.3_ new hello_app
```

### 1.3.1 Bundler

위의 명령어를 실행하면, 파일이 생성 된 뒤, bundle install 명령어를 자동으로 실행한다.
bundle install은 gem file 에 적어놓은 gem 들을 설치하는 명령어이다.
아무튼, 위의 rails new 명령어를 실행하면 많은 파일 및 디렉터리가 생긴다. 이는 레일즈의 장점 중 하나이며, 바로 애플리케이션을 실행 가능하다. 5.2.1장에는 asset pipeline 같은 것들에 대해 설명할 것이다.
[image:9B125B48-A3A0-4575-8566-C62A8ABEDBBF-40121-00004614B35B7A12/image.png]
위와 같이 많은 파일들이 생김.

자, 이제 gemfile 을 살펴보자.
[image:8CBE729E-668F-4F8A-A093-747FC9032DD5-40121-00004615FFDCD4E1/image.png]

[image:4B3795B7-CD10-4C7B-ACF7-4F7B38641804-40121-00004616168CC661/image.png]

대략 이렇게 생겼다.

여기서 대부분의 행이 해쉬 기호( # ) 로 주석 처리되는데, 이것들은 gem에 대한 설명을 표시해 놓은 것이다.

gemfile 에 버전을 명시해놓지 않으면 Bundler가 자동으로 요청하는 최신버전의 gem을 설치한다. 예를들면

```ruby
gem ‘sqlite3’
```

이 gem은 버전 명시를 안해놓았기 때문에 가장 최신버전을 설치한다.

gem 버전 범위를 두가지의 기본적인 방법으로 지정할 수 있고, 이 방법으로 레일즈가 사용하는 버전을 어느 정도 제어할 수 있다.
먼저, 첫번째 방법은 다음과 같다.

```ruby
gem ‘uglifier’, ‘>= 1.3.0’ 
```

>= 1.3.0 은 1.3.0보다 큰 버전을 설치하라는 것이다. 가장 최신버전으로 설치한다.

```ruby
gem ‘coffee-rails’, ‘-> 4.0.0’
```

-> 의 경우에는 4.0.0보다 큰 버전을 설치하는데, 4.1.0 이 아니라 4.0.1~4.0.9 같은 바로 위의 버전을 설치하라는 것이다.
예를들어, -> 4.0 같은 경우에는 5.0 버전이 아니라 4.1~4.9 사이의 버전을 설치하라는 것이다.

사소한 버전 문제에도 프로그래밍이 깨질 수 있기 때문에, 버전 관리를 잘 해야된다.

bundle install을 하면, bundle update를 먼저 하라고 메시지가 뜰 수도 있는데, 그런경우에는 bundle update를 하고 그다음에 install을 하면 된다.

### 1.3.2 rails server

rails new 커맨드와 bundle install로 우리는 실행할 수 있는 애플리케이션을 만들었다. 그러나 어떤 방식으로 실행해야 되나?

rails 에는 rails server라는 커맨드가 제공된다.
이 커맨드를 사용하면 default 3000번 포트에서 서버를 열 수 있게 된다.

#### Exercise

1. 현재 당신이 사용하는 루비 버전은?(ruby -v 커맨드를 사용하세요)
A : 2.7.0

2. rails 의 버전은?
A : 5.2.3

### 1.3.3 Model-View-Controller (MVC)

rails 어플리케이션의 구조를 보면 app/ 이라는 디렉토리 안에 model, view, controller 라는 3가지의 디렉토리가 포함되어있음을 볼 수 있다. 이것은 rails가 MVC 패턴을 따른다는 힌트로서, 애플리케이션의 대이터와 이를 표시하는데 사용되는 코드를 강제로 분리시킨다.
이는 GUI를 구성하는 일반적인 방법이다.

브라우저가 request를 하면 웹서버가 수신하여 레일즈 컨트롤러로 전달되고, 컨트롤러는 다음에 수행할 작업을 담당한다. 바로 HTML로 변환되어 view를 즉시 렌더링 할 수도 있다. 동적 사이트의 경우에는 controller는 데이어베이스와의 통신을 담당하는 루비 객체인 model과 상호 작용한다. model을 호출한 후, 컨트롤러는 view를 렌더링하고 전체 웹 페이지를 HTML로 브라우저에 보낸다.

이러한 형식으로 레일즈 어플리케이션이 구성되어 있다.

### 1.3.4 Hello, world!

MVC 프레임워크의 첫번째 어플리케이션으로 우리는 “hello, world!” 라는 스트링을 렌더링 하는 controller action 을 추가할 것이다.

controller라는 이름에서 알 수 있듯이 controller action은 controller 내부에 정의 되어있다. 우리는 Application controller 에 hello 라는 action을 만들것이다.
Application controller는 이미 가지고 있는 컨트롤러이다.

[image:F77E6677-0E33-4095-B48B-64B0CD6E1F3F-40974-00004860F39AEAAB/image.png]
MVC는 위와같이 구성되어 있다.

경로 : app /controllers /application_controller.rb 
```ruby
class ApplicationController < ActionController::Base 
	protect_from_forgery with: :exception 
	def hello 
		render html: "hello, world!" 
	end 
end
```

이 코드는 html을 렌더링하는 hello 액션을 application controller에 작성한 것이다.
이렇게 원하는 문자열을 반환하는 작업을 정의 한 뒤에 레일즈에게 이 액션을 default page에 띄우라고 지시를 해야한다.
그러려면 라우터를 편집해야 한다. 라우터는 컨트롤러 앞에 위치하며 브라우저에서 들어오는 요청을 어디로 보낼지 결정한다.
지금은 루트 URL에서 나오는 페이지에서 hello 액션을 나오게 할 것이다.
root URL이란 http://www.example.com/ 과 같은 주소에 대한 URL을 말하는 것이다.
이 root URL을 줄여서 / (“slash”) 라고 한다.

root route는 다음과 같이 작성한다.
```ruby
root ‘controller_name#action_name’
```

실제로는 아래와 같이 작성하면 된다.
application 컨트롤러에 있는 액션인 것 이다.
경로 : config /routes.rb
```ruby
Rails.application.routes.draw do 
	root 'application#hello' 
end
```

#### Exercises

1. hello 액션의 내용을 “hola, mundo!” 로 바꿔라
A:
```ruby
class ApplicationController < ActionController::Base 
	protect_from_forgery with: :exception 
	def hello 
		render html: "hola, mundo!" 
	end 
end
```

2. rails가 non-ASCII 문자인 ‘¡’ 를 지원함을 보여라. 맥에서 이 문자를 입력하려면 Option-1 을 누르면 된다.
A:
가능하다.
[image:8A8A0B71-8343-4CAA-9643-6DF4867540BA-40974-000049672A945326/httpnamjin.org3000.png]

3. hello action 예제를 참고하여 두번째 action인 goodbye를 만들고 “goodbye, world!” 를 렌더링해라. 루트 라우트를 hello 대신 goodbye로 만들어라.

A : 
경로 : app/controllers/application_controller.rb
```ruby
class ApplicationController < ActionController::Base
    def hello
        render html: "¡hola, mundo!"
    end

    def goodbye
        render html: "goodbye, world!"
    end
end
```

경로 : rails_project/hello_app/config/routes.rb
```ruby
Rails.application.routes.draw do
  root 'application#goodbye'
end
```

결과 : 
[image:747E97CE-3A4E-4009-BB72-60C1E21CEEA3-41397-00004968FAF18133/사진 2020. 12. 30. 오후 50443.jpg]

## 1.4 Version control with Git

### 1.4.1 Installation and setup
### 1.4.3 What good does Git do you?

위 부분은 git 사용법을 알기 때문에 패스

### 1.4.3 Bitbucket

Git repository를 호스팅하는 가장 인기 있는 사이트는 Github과 Bitbucket이다.
두 서비스 모두 Git repository를 호스팅하고 협업할 수 있을 뿐 아니라 저장소를 쉽게 탐색하고 검색할 수 있다는 공통점을 가지고 있다.
중요한 차이점은 GitHub은 오픈 소스 저장소를 위해 무제한의 무료 저장소를 제공하는 반면, Bitbucket은 특정 수의 공동작업자를 타겟으로 무제한의 개인 저장소를 허용한다는 것이다.
Github에 public 으로 올리면 위험에 쉽게 노출될 수 있어서 private으로 바꿀 것을 권하고 있다. git이 이 정보를 무시하도록 함으로써 이 정보를 안전하게 처리할 수 있도록 준비하는 것은 가능하지만, 오류가 발생하기 쉽고 전문지식이 필요하다. 
github은 private 저장소가 유료였지만, 지금은 bitbucket과 같이 무료이다.
그래서 둘 중 어느것을 써도 상관 없다.
또한 팀프로젝트를 할 때에는 bitbucket이 아닌 gitlab을 사용하면 된다.

### 1.4.4. Branch, edit, commit, merge
생략

## 1.5 Deploying
생략. 이미 code-server로 서버에서 개발중이기 때문에 개발과 배포 둘다 가능하다.

## 1.6 Conclusion
이 챕터에서 설치, 개발환경세팅, 버전 컨트롤, 배포 등에 대해서 배웠다.
다음 챕터에서는 데이터베이스 기반의 top app을 만들 것이다. 

## 1.6.1 What we learned in this chaper
* ruby on rails는 ruby 프로그래밍 언어를 기반으로 쓰여진 웹 개발 프레임워크이다.
* ruby를 설치하고, application을 만들고, 이를 편집하는 방법
* rails new 커맨드를 사용해서 rails app을 만들 수 있고, rails server 커맨드를 사용해서 로컬호스트 실행
* "hello, world" 애플리케이션을 생성하기 위해 controller action 을 추가하고 루트 경로를 수정했다.
* 버전 관리 시스템
* 배포하는 방법